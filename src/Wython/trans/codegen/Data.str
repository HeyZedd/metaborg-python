module Data

imports
  signatures/WebAssembly/WastData-sig
  signatures/WebAssembly/WastExpr-sig
  trans/codegen/-
  ast-syntax/AST-Wython
  ast-syntax/AST-Statement
  ast-syntax/AST-Expression
  
rules

  data:
    callList -> dataList
    where 
    <debug> callList;
    dataList := <map(calls)> callList
      
  calls:
    ExprStmt(Call(name, args, kwargs)) -> dataList
    where
      dataList := <map(dataStmt)> args;
      <debug> dataList

  dataStmt:
    (param) -> 
       WastData(
          WastExpr(WastInstr(I32Const("0"))), 
          Some(val)
        )
      where
        val := <evaluate> param;
        <debug> val
       
  evaluate:
    Int(val) -> val
    
  evaluate:
    String(val) -> val
